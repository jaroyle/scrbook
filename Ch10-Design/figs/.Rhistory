rm(list=ls(all=TRUE))
lower=9
upper=21
delta<- .4 ##1/3   # spacing of design points
pts<-seq(lower,upper,delta)
s1<- sort(rep(pts,length(pts)))
s2<-rep(pts,length(pts))
S<-cbind(s1,s2)
inX<- (s1 <=20 & s1 >=10) & (s2 <=20 & s2>=10)
C<-S[inX,]  # candidate set
#S<-read.csv("mink_activity_centers.csv")
#C<-read.csv("potential_sites.csv")
dim(C)
plot(C)
e2dist
library("scrbook")
ed2idst
e2dist(C[1,],C[-1,])
e2dist(matrix(C[1,],nrow=1),C[-1,])
sort(d)
order(d)
e2dist(matrix(C[1,],nrow=1),C[-1,])->d
order(d)
d
order(d)
inclust<- order(d)
 inclust<- inclust[inclust<4]
inclust
d[inclust]
inclust
 d<- as.vector(e2dist( matrix(C[1,],ncol=2),C[-1,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
avail<- 1:nrow(C)
 d<- as.vector(e2dist( matrix(C[1,],ncol=2),C[-1,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
avail
avail[1:10]
repeat{
 pt<- avail[!is.na(avail)][1]
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
avail<- 1:nrow(C)
clusters<-NULL
repeat{
 pt<- avail[!is.na(avail)][1]
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
avail<- 1:nrow(C)
clusters<-NULL
repeat{
if(all(is.na(avail)) break
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
repeat{
if(all(is.na(avail))) break
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
avail<- 1:nrow(C)
clusters<-NULL
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
dim(clusters)
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
pt
dim(clusters)
dim(avail)
avail
sum(is.na(avail)
)
inclust[1:10]
 pt<- avail[!is.na(avail)][1]
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C[-pt,]))
 d[is.na(inclust)]<-NA
d
sum(is.na(d))
 d[is.na(avail)]<-NA
sum(is.na(d))
sum(is.na(avail))
 inclust<- inclust[inclust<=4 & !is.na(inclust) ]
inclust
d
d[1:20]
avail<- 1:nrow(C)
clusters<-NULL
 pt<- avail[!is.na(avail)][1]
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
d
 d[is.na(avail)]<-NA
sum(is.na(d))
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
dim(clusters)
apply(clusters,1,sum)
sum(is.na(avail))
avail<- 1:nrow(C)
clusters<-NULL
repeat{
if(all(is.na(avail))) break
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
thispt
pt
dim(clusters)
rm(clusters)
avail<- 1:nrow(C)
clusters<-NULL
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
avail
sum(is.na(avail))
inclust
avail<- 1:nrow(C)
clusters<-NULL
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[inclust<=4 ]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
d[1:10]
 inclust<- order(d)
inclust[1:10]
min(inclust)
 inclust<- inclust[inclust<=4 ]
inclust
avail<- 1:nrow(C)
clusters<-NULL
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[1:min(4)]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[1:min(4)]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
avail
sum(is.na(avail))
dim(clusters)
clusters[1:2,]
apply(clusters,1,sum))
apply(clusters,1,sum)
apply(clusters,2,sum)
avail<- 1:nrow(C)
clusters<-NULL
repeat{
if(all(is.na(avail))) break
 pt<- avail[!is.na(avail)][1]
cat(pt)
 d<- as.vector(e2dist( matrix(C[pt,],ncol=2),C ))
 d[is.na(avail)]<-NA
 inclust<- order(d)
 inclust<- inclust[1:min(4)]
 avail[inclust]<-NA
 thisclust<-rep(0,nrow(C))
 thisclust[inclust]<-1
 clusters<-rbind(clusters,thisclust)
}
dim(clusters)
apply(clusters,1,sum)
save.image()
Cd<-round(e2dist(C,C),8)  # distance among candidates
dim(Cd)
dim(clusters)
Cd%*%t(clusters)->a
dim(a)
clusters%*%Cd%*%t(clusters) ->a
dim(a)
a[1:4,1:4]
