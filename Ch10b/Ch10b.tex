\chapter{
Modeling Space Usage:
Integrating Resource Selection Information with
Spatial Capture-Recapture
  Models}

\markboth{Resource Selection and Space Usage}{}
\label{chapt.rsf}


\vspace{.3in}

Up to this point we have developed many specific variations of
relatively simple SCR models. They included different models of the
observation process, models of the relationship between encounter
probability and distance, and different types of covariates including
behavioral responses and other things that should affect detection
probability.  That said, the models remain pretty basic in the sense
that they imply simplistic models of how individuals use space
(section \ref{scr0.sec.implied}) and how individuals are distributed
in space.  In the following several chapters we generalize some of the
core SCR assumptions to accommodate more realistic notions of how
animals use space.

In this chapter we extend our notion of encounter probability models
as models of space usage or resource selection
(sec. \ref{scr0.sec.implied}), by extending them to include one or
more explicit landscape covariates, which the investigator believes
should affect how individual animals use space. We do this in a way
that is entirely consistent with the manner in which classical
``resource selection function'' (RSF) models are estimated from animal
telemetry data.  In fact, we argue there that SCR models and RSF
models based on telemetry are based on the same basic underlying model
of space usage. The important distinction between SCR and RSF data are
that, in SCR models, encounter of individuals is imperfect (i.e.,
``$p<1$'') whereas, with RSF data obtained by telemetry, encounter is
perfect\footnote{this is not strictly true -- rather, detection is not
  a {\it stochastic} outcome.}. We can think of the two as being
exactly equivalent either if we have a dense array of trapping
devices, or if our telemetry apparatus is imperfect such as only
samples a small area of space (this would be consistent with telemetry
stations for sampling fish which only measure passage).  A key concept
that we must confront in order to unify and integrate SCR and RSF data
is that we need to formulate both models in terms of a common latent
variable so that we can make them consistent with respect to some
underlying space utilization process.

Here we show how to integrate standard RSF type data obtained from
telemetry into SCR models to model space usage explicitly.  This
produces asymmetric, irregular and non-stationary home ranges, and
allows us to make formal inferences about factors that influence home
range geometry and morphology directly from SCR data.  We begin by
describing a model for space usage that exists independent of how we
obtain the data (whether by telemetry or by capture-recapture). The
model posits that individuals use space in proportion to one or more
measurable covariates, say $z({\bf x})$, defined for every pixel or
location ${\bf x}$.  Then we introduce observation models consistent
with both standard capture-recapture methods and telemetry.  This
allows us to define a general likelihood function that is the product
of the two components, if they are both simultaneously available.  In
the absence of RSF data from telemetry, the model reduces to an
ordinary SCR model but with a spatial covariate $z({\bf x})$ affecting
encounter probability.  The modeling framework solves two important
technical problems simultaneously: (1) It allows us to estimate RSF
parameters directly from SCR data, i.e., {\it absent} telemetry data;
and (2) it allows us to integrate telemetry data directly into SCR
models to improve estimates of model parameters, including of density.

\begin{comment}
In our formulation we estimate the latent ${\bf s}$ variables from the observed telemetry
data, just as a convenience, but this wouldn't be necessary.
Also we assume the data are independent pieces but if some of the SCR
individuals are the same as the telemetered individuals then we should
probably account for that explicitly. So right now we pretend we don't
know anything about the telemetered guys in terms of their capture
history. So they don't contribute to information about baseline
encounter probability, just to estimates of the other encounter model
parameters.
\end{comment}



\section{Basic Model of Space Usage}
\label{rsf.sec.rsfmodel}

We develop the model here in terms of a discrete landscape purely for
computational expediency. That said, essentially no landscape on your
computer is continuous, except in the rare case that the landscape is
defined strictly in terms of variables that themselves are inherently
continuous -- e.g., ``distance to road'' or something like that.  But
almost all habitat or landscape structure data comes to us in the form
of raster data.  Let ${\bf x}_{1},\ldots,{\bf x}_{nG}$ identify the center
coordinates of a set of $nG$ pixels that define a landscape.
We organize them into a matrix
${\bf X}_{nG \times 2}$.  Let $z({\bf x})$ denote a covariate measured
(or defined) for
every pixel ${\bf x}$. For clarity, we develop the basic ideas here in terms of a
single covariate but, in practice, investigators typically have more
than 1 covariate. The formulation of the model is unaffected by
whether we have one or multiple such covariates. 

We suppose that a population of individuals wanders around space in
some manner related to the covariate $z({\bf x})$, and their locations
accumulate in pixels by some omnipotent accounting mechanism. We will
define ``use of ${\bf x}$'' to be the event that an individual animal
appeared in some pixel ${\bf x}$. This is equivalently stated in the
literature in terms of individual having {\it selected} ${\bf x}$ but
the latter term implies some kind of psychological process or
conscious intent, and so we keep to the term {\it use} as much as
possible.  Also, as a biological matter, use is the outcome of
individuals moving around their home range but, i.e., where an
individual is at any point in time is the result of some movement
process. But, to understand space usage, it is not necessary to
entertain explicit models of movement, just to observe the outcomes,
and so we don't elaborate further on what could be sensible or useful
models of movement.

Let $n_{ij}$ be the number of times individual $i$ used pixel $j$
during some period of time, i.e., the use frequencies.  We assume the
following probability mass function for the distribution of use
frequencies:
\[
{\bf n}_{i} \sim \mbox{Multinom}({\bm \pi}_{i})
\]
where
\[
 \pi_{ij} = \frac{ exp( -\alpha_{2} z({\bf x}) ) }{ \sum_{x}
   exp(-\alpha_{2} z({\bf x}))}
\]
This is the standard RSF model \citep{manly_etal:2002} used to model
telemetry data.  In practice, we don't get to observe $n_{ij}$ for all
individuals but, instead, only for a small subset which we capture and
install telemetry devices on.  For these telemetered individuals we
accumulate individual- and pixel-specific frequencies, at a lower
sampling rate than actual individual use. For example, we might choose
to record the location of an individual every hour or day or
whatever. As such, the observed frequency of pixel use is a {\it
  sample} of use but, if the recording is random or systematic (or
otherwise unrelated to {\it where} individuals are located), then we
can imagine that the same model of space usage applies. (formally, we
suppose that the observed frequencies are a binomial sample with
sample size $n_{ij}$ and sampling intensity $\phi_{0}$ lets say, and
we see that the constant $\phi_{0}$ cancels from the expression for
the multinomial cell probabilities above).  Therefore, for the
telemetered individuals, we adopt the standard RSF model which has
probabilities as above:
\[
 \pi_{ij} = \frac{ exp( -\alpha_{2} z({\bf x}_{j}) ) }{ \sum_{x}   exp(-\alpha_{2} z({\bf x}_{j}))}
\]
We extend this model slightly to make it more realistic spatially. Let
${\bf s}$ denote the centroid of an individuals home range and let
$D_{ij} = ||{\bf x}_{j} - {\bf s}_{i}||$ be the distance from the home
range center of individual $i$, ${\bf s}_{i}$, to pixel $j$, ${\bf
  x}_{j}$. We modify the space usage model to accommodate that space
use will be concentrated around an individuals home range centroid:
\begin{equation}
 \pi_{ij} = \frac{ exp( -\alpha_{1} D_{ij}^{2} -\alpha_{2} z({\bf x}_{j}) ) }
{ \sum_{x} exp(-\alpha_{1} D_{ij}^{2} -\alpha_{2} z({\bf x}_{j}))}
\label{rsf.eq.rsf}
\end{equation}
which we see now is beginning to resemble standard encounter models
used in spatial capture-recapture but with an additional covariate
$z({\bf x})$ (and see Chapt. \ref{chapt.poisson-mn}).
In particular, under this model for space usage or resource selection,
if you have no covariates at all, or if $\alpha_{2} =
0$, then
the probabilities $\pi_{ij}$ are directly proportional to the SCR
model for encounter probability.
For example, setting $\alpha_{2} = 0$, then this implies probability
of use for pixel $j$ is:
\[
p_{ij} \propto  exp( -\alpha_{1} D_{ij}^{2})
\]
so whatever function of distance we use in our RSF implies an
equivalent model of space usage (sec. XXX in Chapt. \ref{chapt.scr0}) when used in SCR models.

As an illustration of space usage patterns under this model, we
simulated a covariate that we feel represents typical patterns of
variation in habitat
structure (Fig. \ref{rsf.fig.habitat}) such as might correspond to
habitat quality. 
\begin{figure}
\centering
\includegraphics[width=3.5in,height=3.5in]{Ch10b/figs/habitat}
\caption{A typical habitat covariate reflecting habitat quality or
  hypothetical utility of the landscape to a species under study. Home range centers for 8 individuals are
shown with black dots.}
\label{rsf.fig.habitat}
\end{figure}
This was simulated by using a
basic kriging model with the following {\bf R} commands:
\begin{verbatim}
set.seed(1234)
gr<-make.statespace(minx=1,maxx=40,miny=1,maxy=40,nx=40,ny=40)
Dmat<-as.matrix(dist(gr))
V<-exp(-Dmat/5)
z<-t(chol(V))%*%rnorm(1600)
spatial.plot(gr,z)
\end{verbatim}
The functions \mbox{\tt make.statespace} and \mbox{\tt spatial.plot} are
both in the \mbox{\tt scrbook} package.
Space usage patterns for 
 8 individuals are shown in Fig. \ref{rsf.fig.homeranges},
simulated with $\alpha_{1} = 1/(2\sigma^2)$ with $\sigma = 2$ and the
coefficient on $z({\bf x})$ set to $\alpha_{2} = 1$.  
\begin{figure}
\centering
\includegraphics[width=3.5in,height=3.5in]{Ch10b/figs/homeranges8}
\caption{Space usage patterns of 8 individuals under a space usage
  model that contains a single covariate (shown in
  Fig. \ref{rsf.fig.habitat}). Plotted value is the multinomial
  probability $\pi_{ij}$ for pixel $j$ under the model in Eq. \ref{rsf.eq.rsf}.
}
\label{rsf.fig.homeranges}
\end{figure}
These space usage densities -- ``home ranges'' -- exhibit clear
non-stationarity in response to the structure of the underlying
covariate, and they are distinctly asymmetrical.  We note that if
$\alpha_{2}$ were set to 0, the 8 home ranges shown here would
resemble bivariate normal kernels with $\sigma = 2$.  Another
interesting thing to note is that the activity centers are not
typically located in the pixel of highest use or even the centroid of
usage. That is, the observed ``average'' location is not, in fact, an
unbiased estimator of ${\bf s}$ under the model in
Eq. \ref{rsf.eq.rsf}. 


\subsection{Poisson use model}

A natural way to motivate this specific model of space usage is to
assume that individuals make a sequence of random resource selection
decisions so that the outcome of $n_{ij}$ are marginally {\it
  independent}, having a Poisson distribution:
\[
 n_{ij} \sim \mbox{Poisson}( \lambda_{ij})
\]
where
\[
 log(\lambda_{ij}) = a_{0}  + \alpha_{2} z({\bf x})
\]
In this case,
 the number of visits to any particular cell is affected by
the covariate $z({\bf x})$ but has a baseline rate ($exp(a_{0})$) related to the amount
of movement, or number of selection decisions which is essentially
just related to the time interval over which the animal is using
space. i.e., longer time intervals lead to higher values of
$E(n_{ij})$.
This is an equivalent model to the multinomial model given previously
in the sense that, if we condition on the total sample size $n_{i.} =
\sum_{j} n_{ij}$, then the vector ${\bf n}_{i}$ has a multinomial
distribution with probabilities
\[
 \pi_{ij} = \frac{\lambda_{ij}}{ \sum_{j} \lambda_{ij}}
\]
as we discussed in Chapt. \ref{chapt.poisson-mn}.  We see that the
intensity parameter $a_{0}$ is not relevant for understanding
patterns of space usage. In particular, it cancels from the numerator
and denominator of the multinomial cell probabilities, analogous to
what happens under sampling of individual use decisions as discussed
above. 

\begin{comment}
{\bf note:} while Poisson -> multinomial, it is not vice versa. If the total
sample size per individual is fixed, then the marginals are NOT
Poisson and that model will produce biased estimators.

For purposes of estimation we can use either the Poisson or
multinomial likelihoods. In the former case, we have to estimate an
individual-specific nuisance 
parameter $a_{0}$, from which information is derived by the total
number of observations whereas, in the later case, we lose information
about $a_{0}$ by conditioning on the total (i.e., treating it as
fixed).  As it often is fixed, or at least the number of telemetry
observations is completely arbitrary, $a_{0}$ is usually a meaningless
parameter so whether we estimate it or not is immaterial from a
practical standpoint.
\end{comment}

\subsection{Thinning}

Suppose our sampling is imperfect so that we only observe a smaller
number of telemetry fixes than actual uses, $n_{ij}$. As developed in
sec. \ref{scr0.sec.implied}, we assume that the observed number of
uses is
\[
 m_{ij} \sim \mbox{Bin}(n_{ij}, \phi_{0}).
\]
In this case, the marginal distribution of $m_{ij}$ is also Poisson
but with intensity $\lambda_{0} = log(\phi_{0}) + a_{0} +
\alpha_{2}z(x)$.  In this case, the space-usage model (RSF) for the
thinned counts $m_{ij}$ is the same as the space-usage model for the
original variables $n_{ij}$.  This is because if we remove $n_{ij}$
from this model by summing over possible values, then the vector of
${\bf m}_{i}$ has a multinomial with cell probabilities
$\lambda_{0}\pi_{ij}$ and we see that $\lambda_{0}$ cancels.

%That is,
%given our sequence of
%independent Poisson random variables and we condition on their total,
%i.e., regard it as fixed, then we have the multinomial. In the
%multinomial we lose information about the intercept which in this case
%is ok because we only care about the interpretation of the resource
%selection model as a probability distribution and don't care about the
%basic rate of detection -- and it is a confounding of animal use and a
%fixed sampling intensity.

In summary, if we conduct a telemetry study we observe ${\bf n}_{i}$,
the $nG \times 1$ vector of pixel-counts for each individual
$i=1,\ldots,N_{tel}$.  We declare these data to be
``resource-selection data'' which are typical of the type used to
estimate resource-selection functions (RSFs) \citep{manly_etal:2002}.
Sometimes in RSF modeling activities people make believe they have
continuous covariates and so the denominator in Eq. \ref{rsf.eq.rsf}
involves an integration over a distribution for the covariate which is
the conditional intensity of observed point locations in a point
process model. However, in a discrete landscape, entertaining pdfs for
the covariates isn't necessary \citep{royle_etal:2012mee}.\hl{Or is it
  that they ignore the fact that they are sampling 2D space? They seem
  to act as if they are sampling K-dimensional covariate space.}
\hl{yea, this could be it. lets contemplate this}

\subsection{Capture-recapture Data}

The key to combing RSF data with SCR data is to work with this
underlying resource utilization process and formulate SCR models in
terms of that process. For SCR models it will serve as a intermediate
latent that we don't get to observe. We assume that, fundamentally,
both telemetered individuals and SCR individuals are using space
according to the same resource selection model. The difference is that,
for SCR data, we dissolve out most of the sampling devices so that
data are only recorded at a subsample of them.
In other words, imagine that we have a sampling device, such as a
camera trap, in {\it every} pixel. If the device operates continually
then it is no different from a telemetry instrument. If it
operates  intermittently and does not expose the entire area of
each pixel then a reasonable model for this imperfect observation is
the ``thinned'' binomial model given above, where $\lambda_{0}$
represents the sampling effectiveness of the device. So we imagine
that the hypothetical perfect data from a camera trapping study are
the counts $m_{ij}$.

We then construct our SCR encounter probability model based on the
view that these frequencies $m_{ij}$ are {\it latent}. In particular,
under the SCR model with binary observations,
 we observe a random variable
$y_{ij} = 1$  if the individual $i$ visited the pixel
containing a trap and was detected.
We imagine that $y_{ij}$ is related to the latent variable $m_{ij}$ being the
event $m_{ij}>0$, which occurs with probability
\[
 p_{ij} = 1-exp(- \lambda_{0} \lambda_{ij})
\]
we see that $\lambda_{0}$ is a baseline encounter rate which includes
the constant intensity of use by the individual and also the baseline
rate of detection conditional on use.



\section{The Joint RSF/SCR Likelihood}

To construct the likelihood for SCR data when we have auxiliary
covariates on space usage {\it or} direct information on space usage
from telemetry data, we regard the two samples (SCR and RSF) as
independent of one another. In practice, this might not always be the
case but (1) often time the telemetry data come from a previous study;
(2) the individuals are not the same at all; (3) or even if they are
some of the same individuals being captured, we might not be able to
match individuals captured by a sampling method such as hair-snares
with the individuals wearing radio-collars; (4) In cases where we {\it
  can} match some individuals between the two samples, regarding them as
independent should only entail an incremental loss of efficiency
because we are disregarding more precise information on a small number
of activity centers. Moreover, we believe, it is unlikely in practice
to expect the two samples to be completely reconcilable and that the
independence formulation is the most generally realistic. 

Anyhow, regarding the two data sets independently, our approach here
is to form the likelihood for each set of observations as a function
of the same underlying parameters and then combine them. In
particular, let ${\cal L}_{scr}(\alpha_{0}, \alpha_{1}, \alpha_{2}, N;
{\bf y}_{scr})$
be the likelihood for the SCR data in terms of the basic encounter
probability parameters and the total (unknown) population size $N$,
and let ${\cal L}_{rsf}(\alpha_{1},\alpha_{2}; {\bf m}_{rsf})$ be the
likelihood for the RSF data based on telemetry which, because the
sample size of such individuals is fixed, does not depend on $N$.
The
joint likelihood is the product of these two pieces:
\[
{\cal L}_{rsf+scr}(\alpha_{0},\alpha_{1},\alpha_{2},N; {\bf y}_{scr},{\bf
  m}_{rsf})  = {\cal L}_{scr} \times {\cal L}_{rsf}
\]
In what follows, we provide a formulation of each likelihood
component, along with an {\bf R} function for obtaining the MLEs of
model parameters using standard methods available in {\bf R}.

The observation model for the SCR data for individual $i$ and trap $j$,
from sampling over $K$ encounter periods, is:
\[
 y_{ij}|{\bf s}_{i} \sim \mbox{Bin}(K; p_{ij})
\]
where
\[
 p_{ij} = 1-exp(- \lambda_{ij} )
\]
and
\[
 \lambda_{ij} = \lambda_{0} exp(- \alpha_{1} D_{ij}^{2} + \alpha_{2}  z(x_{j}) )
\]
A compact expression of these model components is:
\begin{equation}
y_{ij}| {\bf s}_{i} \sim \mbox{Bin}(K, p_{\alpha}(D_{ij}; {\bm \alpha}))
\label{rsf.mle.eq.cond-on-s}
\end{equation}
We emphasize that this is conditional on the latent variables ${\bf
  s}_{i}$ (which appear in $D_{ij}$). For these latent variables we
adopt the standard assumption of uniformity, ${\bf s}_{i} \sim
\mbox{Unif}({\cal S})$.  The joint distribution of the data for
individual $i$, conditional on ${\bf s}_{i}$, is the product of $J$
binomial terms (i.e., the contributions from each of $J$ traps):
\[
  [{\bf y}_{i} | {\bf s}_{i} , {\bm \alpha}] =
  \prod_{j=1}^{J} \mbox{Bin}(K, p_{\alpha}({\bf x}_{j},{\bf s}_{i}) )
\]
The so-called marginal likelihood \citep{borchers_efford:2008} is
computed by removing ${\bf s}_{i}$, by integration, from the
conditional-on-${\bf s}$ likelihood and regarding the {\it marginal}
distribution of the data as the likelihood. That is, we compute:
\[
  [{\bf y}_{i}|{\bm \alpha}] =
\int_{{\cal S}}  [ {\bf y}_{i} |{\bf s}_{i},{\bm \alpha}] g({\bf s}_{i}) d{\bf s}_{i}
\]
{\flushleft where}, under the uniformity assumption, we have
$g({\bf s}) = 1/||{\cal S}||$.
The joint likelihood for all $N$ individuals,
is the product of $N$ such terms:
\[
{\cal L}_{scr}({\bm \alpha} | {\bf y}_{1},{\bf y}_{2},\ldots, {\bf y}_{N}) = \prod_{i=1}^{N}
[{\bf y}_{i}|{\bm \alpha}]
\]
Now, in practice, we don't know $N$ and so we can't just compute the
SCR likelihood in this manner. Following our development in
Chapt. \ref{chapt.mle}, 
we can compute the contributions of the
$n$ observed individuals, but then we have to compute the likelihood
contribution for the ``all 0'' encounter history, i.e., that
corresponding to unobserved individuals. The mechanics of computing
that are the same as for an ordinary observed encounter history. We
then have to deal with the issue that $n$ itself is a random variable,
and that leads to the combinatorial term in front of the likelihood
which involves the total population size $N$.

For the RSF data from the sample of individuals with telemetry devices
we adopt the same basic strategy of describing the
conditional-on-${\bf s}$ likelihood and then computing the marginal
likelihood by averaging over possible values of ${\bf s}$.
We have ${\bf m}_{i}$, the vector of pixel counts for individual $i$,
where these counts are derived from a telemetry study or similar.
Their likelihood contribution is
proportional to
\[
 {\cal L}_{rsf}({\bm \alpha}, {\bf m}_{rsf})
 = \prod_{g=1}^{G}  \pi_{ij} ^{m_{ij}}
\]
where
\[
 \pi_{ij} =  = \frac{ exp( -\alpha_{1} D_{ij}^{2} -\alpha_{2} z({\bf x}_{j}) ) }
{ \sum_{g} exp(-\alpha_{1} D_{ij}^{2} -\alpha_{2} z({\bf x}_{j}))}
\]

Technical details for computing the likelihood and obtaining the MLEs
are given in Appendix XXXXXXX where we provide an ${\bf R}$ function to
evaluate the likelihood and obtain the MLEs.  
\begin{verbatim}

Script here

\end{verbatim}
A key practical detail
is that the likelihood here is formulated in terms of the parameter
$N$, the population size for the landscape defined by ${\cal
  S}$. Given ${\cal S}$, density is computed as $D({\cal S}) =
N/||{\cal S}||$. In our simulation study below we report $N$ as the
two are equivalent summaries of the data set once ${\cal S}$ is
defined.


\section{Illustration}


We carried-out a simulation study using the landscape shown in
Fig. \ref{rsf.fig.habitat}, and based on a population of 
$N=100$ individuals with activity centers distributed uniformly over
the landscape.
This patchy covariate was simulated by
generating a field of spatially correlated noise to
emulate a typical patchy habitat covariate (''patchy landscape'') such as
tree or understory density, or some other covariate relevant to
habitat quality for a species. 
We subjected individuals to sampling using 
a $7 \times 7$ array of trapping devices located on the 
the integer coordinates $(u*5,v*5)$ for $u,v = 1,2,3,4,5,6,7$.

We simulated a few cases.... 2, 4, 8, 12, 16 telemetered individuals
with 20 telemetry fixes {\it per} individual. 

Small simulation study -- ordinary SCR data with intense resource selection,
using 0, 2, 4, 8, 10 telemetered individuals sampled 50 times each.
(1) Does SCR model with NO RSF Data give good estimates of the RSF?
(2) improvement as we add a few guys.

\begin{verbatim}
8 telemetered guys with 20 radio fixes each
     N                              alpha2                 sigma
> smy(simout0)
[1] 100.0267401  11.1822635   1.0156668   0.1305527   2.0013387   0.1212982
> smy(simout8.20)
[1] 99.51375304 10.52010114  0.99605137  0.10771422  2.00517378  0.06734584
> smy(simout8.20b)
[1] 96.77379169 10.79090107  0.85426516  0.17866949  1.96456423  0.07593414
> smy(simout8.20c)
[1]         NA         NA 0.97038283 0.17222559 2.00868789 0.08629077
\end{verbatim}

I think the bias when estimating "s" seems reasonable: The average
location of an individual would be unbiased for "s" only if the guys
is not moving according to a stationary isotropic kernel. Under the
model of space usage with z(x), then the average location is biased to
favor good values of z(x) and so "sbar" is really biased for
"s". Hence the bias.


\section{Summary and Outlook}

This shit is epic, beyond imagination.


How animals use space is a fundamental interest to ecologists, and
important in their conservation and management. Normally this is done
by telemetry and models referred to as resource selection functions
\citep{manly_etal:2002}.  Conversely, spatial capture-recapture models
have grown in popularity over the last several years
\citep{borchers_efford:2008, royle:2008, royle_etal:2009ecol,
  gardner_etal:2010, gardner_etal:2011, kery_etal:2010,
  gopalaswmany_etal:2012} XXX More here XXXX. SCR models are regarded
more as methods for estimating density. Although models of space usage
seem to underly the simplistic models for encounter probability, this
notion of the relationship between encounter probability and space
usage has not been developed explicitly in the literature.  Indeed,
essentially all published applications of SCR models to date have been
based on simplistic encounter probability models that are symmetric,
constant among individuals and do not vary across space. One exception
is \citet{royle_etal:2012ecol} who developed SCR models that use
ecological distance metrics instead of normal Euclidean distance. Here
we developed an SCR model in terms of a basic underlying model of
space or resource use, that is consistent with existing views of
resource selection functions (RSFs) \citep{manly_etal:2002}.

In developing the SCR model in terms of an underlying model of space
usage, we achieve a number of enormously useful extensions of SCR
models. First, we have 
 shown how to integrate classical RSF data from telemetry
with spatial capture-recapture data based on individual encounter
histories obtained by classical arrays of encounter devices or
traps. This leads to an improvement in our ability to estimate
density, and also an improvement in our ability to estimate parameters
of the RSF function.  Thus, the combined model is both an extension of
standard SCR models and also and extension of standard RSF models. As
many animal population studies have auxiliary telemetry information,
the ability to incorporate such information into SCR studies has
enormous applicability and immediate benefits in many studies. 
Secondly, we have shown that one can estimate RSF model parameters
directly from SCR data {\it alone}. This establishes clearly that SCR
models {\it are} explicit models of space usage. Thirdly, it is also
now clear that one of the important parameters of SCR models, that
controlling ``home range radius'', is also directly estimable from
telemetry data alone. While this is of less practical relevance, it
does suggest that one might be able to estimate density with very
sparse data and few actual
recaptures of individuals, by having good estimates of $\sigma$ from
auxiliary data. This is an idea exploited by \citet{chandler_royle:2012}. 

Use of telemetry data in capture-recapture studies has been suggested
previously. For example, Ivans et al. XXXX and Shenk and White XXXX
have suggested using telemetry data to estimate the vague quantity
``probability that a guy is exposed to sampling'' but they do not
propose ways of adjusting estimates of that quantity for spatial
sampling bias in the individuals that are telemetered. In addition,
they do not directly integrate the telemetry data with the
capture-recapture model so that common parameters are jointly
estimated. In fact, they don't even acknowledge shared parameters of
the two models. 
Sollmann et al. (XXXX) did recognize this. They used some telemetry
data........
also huge improvement, but no resource selection component to the
modell... just space usage.

Our new model allows investigators to model how the landscape and
habitat 
influence movement and space usage of individuals around their home
range, using non-invasively collected capture-recapture data or
capture-recapture data augmented with telemetry data.  This should
improve our ability to understand, and study, aspects of space usage
and it might, ultimately, aid in 
 addressing conservation-related
problems such as reserve or corridor design. And, it should 
greatly expand the relevance and utility of spatial capture-recapture 
beyond simply its use for density estimation.

We developed a formal analysis framework here based on 
marginal likelihood \citep{borchers_efford:2008}
(see Chapt. \ref{chapt.mle}).
In principle,
Bayesian analysis does not pose any unique challenges for this new
class of models although we expect some loss of computational
efficiency due to the increased number of times the components of the
likelihood would need to be evaluated.  We imagine that some problems
would benefit from a Bayesian formulation, however. For example, using
an open population model that allows for recruitment and survival over
time \citep{gardner_etal:2010} is convenient to develop in the {\bf
  BUGS} language and incorporating information on unmarked individuals
has been done using Bayesian formulations of SCR models
\citep{chandler_royle:2012, sollmann_etal:2012}. 

In our formulation of the joint likelihood for RSF and SCR data, we
assumed the data from a capture-recapture and telemetry studies were
independent of one another. This implies that whether or not an
individual enters into one of the data sets has no effect on whether
it enters into the other data set. We cannot foresee situations in
which violation of this assumption should be problematic or invalidate
the estimator under the independence assumption.  In some cases it
might so happen that some individuals appear in {\it both} the RSF and
SCR data sets. In this case, ignoring that information should entail
only an incremental decrease in precision because a slight bit of
information about an individuals activity center is
disregarded. Heuristically, an SCR observation (encounter in a trap)
is like 1 additional telemetry observation, and so we are treating the
two pieces of information as having separate activity centers in the
model developed here.  Our model pretends that we don't know anything
about the telemetered individuals in terms of their encounter history
in traps.  In principle it shouldn't be difficult to admit a formal
reconciliation of individuals between the two lists. In that case, 
we just combine the two conditional
likelihoods before we integrate ${\bf s}$ from the conditional
likelihood. This would be almost trivial 
to do if {\it all} individuals were reconcilable (or none as in the
case we have covered here) but, in general , we think you will always have an
intermediate case -- i.e., either none will be or at most a subset of
telemetered guys will be known. More likely you have "well, that guy
looks telemetered but we don't know which guy it is....hmmm" and that
case, basically a type of marking uncertainty or misclassification, is
clearly more difficult to deal with.





















