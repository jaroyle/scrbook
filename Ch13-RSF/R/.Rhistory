library(scrbook)
data(nybears)
y<-nybears$y2d
K<-nybears$K
X<-nybears$traplocs
z<-nybears$elevation
t2r<-nybears$trap2raster
gr<-nybears$ssgrid
# Basic SCR model with RSF covariate at trap locations. 
tmp1c.1<-nlm(intlik3rsf.v2,c(-3,log(3),1,0),y=y,K=K,X=X,ztrap=z[t2r],G=gr,hessian=TRUE)
# Basic SCR model with RSF covariate at trap locations. 
tmp1c.1<-nlm(intlik3rsf,c(-3,log(3),1,0),y=y,K=K,X=X,ztrap=z[t2r],G=gr,hessian=TRUE)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2)  # traps where captures happened.
points(X,pch="x")
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2)  # traps where captures happened.
points(X,pch="x")
spatial.plot(gr,z)
library(scrbook)
data(nybears)
y<-nybears$y2d
K<-nybears$K
X<-nybears$traplocs
z<-nybears$elevation
t2r<-nybears$trap2raster
gr<-nybears$ssgrid
ntel<-nybears$ntel
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2)  # traps where captures happened.
points(X,pch="x")
X
dim(X)
traplocs
X
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.05)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="X")
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.05)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="X")
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="X",lwd=2)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="X",lwd=3)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="0",cex=2)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch="0",cex=1.5)
tmp
tmp<-X[col(y)[y>0],]
tmp
dim(y)
apply(y,2,sum)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)+1
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=totals/2)
table(totals)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)+1
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=log(totals)+1)
elev
elevation
z
z[t2r]
plot(z[t2r],log(totals))
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)+1
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=log(totals)+1)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)+1
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=log(totals))
points(X[totals==0,],pch="0")
totals
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=log(totals))
points(X[totals==0,],pch="0")
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,cex=(totals))
points(X[totals==0,],pch="0")
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=20,pch=as.character(totals))
#points(X[totals==0,],pch=as.character(totals))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=as.character(totals))
#points(X[totals==0,],pch=as.character(totals))
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=as.character(totals),lwd=2)
#points(X[totals==0,],pch=as.character(totals))
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X,pch=as.character(totals),lwd=3)
#points(X[totals==0,],pch=as.character(totals))
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=as.character(totals[totals>0])/2+1)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/2+1)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/3+1)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/3+1)
points(X[totals==0,],pch="0")
png("elev_captures.png",width=7,height=7,units="in",res=400)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/3+1)
points(X[totals==0,],pch="0")
dev.off()
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y>0,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/3+1)
points(X[totals==0,],pch="0")
library(scrbook)
data(nybears)
y<-nybears$y2d
K<-nybears$K
X<-nybears$traplocs
z<-nybears$elevation
t2r<-nybears$trap2raster
gr<-nybears$ssgrid
ntel<-nybears$ntel
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y>0,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/3+1)
points(X[totals==0,],pch="0")
totals
table(totals)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y>0,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/2)
points(X[totals==0,],pch="0")
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y>0,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/2 +1)
points(X[totals==0,],pch="0")
png("elev_captures_bw.png",width=7,height=7,units="in",res=400)
par(mar=c(3,3,3,6))
spatial.plot(gr,z)
tmp<-X[col(y)[y>0],]
tmp<-tmp + rnorm(prod(dim(tmp)),0,.1)
totals<-apply(y>0,2,sum)
#points(tmp,lwd=2,pch=20)  # traps where captures happened.
points(X[totals>0,],pch=20,cex=totals[totals>0]/2 +1)
points(X[totals==0,],pch="0")
dev.off()
