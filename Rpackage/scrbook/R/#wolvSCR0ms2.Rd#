\name{wolvSCR0ms2}
\alias{wolvSCR0ms2}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
%%  ~~function to do ... ~~
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
wolvSCR0ms2(y3d, traps, nb = 1000, ni = 2000, buffer = 2, M = 200)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{y3d}{
%%     ~~Describe \code{y3d} here~~
}
  \item{traps}{
%%     ~~Describe \code{traps} here~~
}
  \item{nb}{
%%     ~~Describe \code{nb} here~~
}
  \item{ni}{
%%     ~~Describe \code{ni} here~~
}
  \item{buffer}{
%%     ~~Describe \code{buffer} here~~
}
  \item{M}{
%%     ~~Describe \code{M} here~~
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (y3d, traps, nb = 1000, ni = 2000, buffer = 2, 
    M = 200) 
{
    library("R2WinBUGS")
    traplocs <- as.matrix(traps[, 2:3])
    mingridx <- min(traplocs[, 1])
    mingridy <- min(traplocs[, 2])
    traplocs[, 1] <- traplocs[, 1] - min(traplocs[, 1])
    traplocs[, 2] <- traplocs[, 2] - min(traplocs[, 2])
    traplocs <- traplocs/10000
    ntraps <- nrow(traplocs)
    Xl <- min(traplocs[, 1] - buffer)
    Xu <- max(traplocs[, 1] + buffer)
    Yl <- min(traplocs[, 2] - buffer)
    Yu <- max(traplocs[, 2] + buffer)
    area <- (Xu - Xl) * (Yu - Yl)/10
    nz <- M - dim(y3d)[1]
    wsex <- c(wsex, rep(NA, nz))
    MASK <- traps[, 4:ncol(traps)]
    Dmat <- as.matrix(dist(traplocs))
    nind <- dim(y3d)[1]
    K <- dim(y3d)[2]
    newy <- array(0, dim = c(nind + nz, K, ntraps))
    for (j in 1:nind) {
        newy[j, 1:K, 1:ntraps] <- y3d[j, 1:K, 1:ntraps]
    }
    y3d <- newy
    M <- nind + nz
    K <- apply(MASK, 1, sum)
    y <- apply(y3d, c(1, 3), sum)
    sink("modelfile5.txt")
    cat("\nmodel {\n\nfor(i in 1:3){\nalpha0[i] ~ dnorm(0,.1)\nsigma[i] ~ dunif(0,5)\nbeta[i]<- 1/(2*sigma[i]*sigma[i])\n}\n\npsi ~ dunif(0,1)\nmod~  dcat(mod.probs[])\nmod.probs[1]<- 1/3\nmod.probs[2]<- 1/3\nmod.probs[3]<- 1/3\n\nfor(i in 1:M){\n w[i]~dbern(psi)\n s[i,1]~dunif(Xl,Xu)\n s[i,2]~dunif(Yl,Yu) \n\nlogit(p0[i,1])<- alpha0[1]\nlog(p0[i,2])<- alpha0[2]\np0[i,3]<- alpha0[3]\nbeta.vec[i,1]<- beta[1] \nbeta.vec[i,2]<- beta[2]  \nbeta.vec[i,3]<- beta[3] \n\nfor(j in 1:ntraps){\n\n mu[i,j]<-w[i]*p[i,j,mod]\n y[i,j]~ dbin(mu[i,j],K[j]) \n\n dist2[i,j]<- pow(s[i,1] - traplocs[j,1],2)  + pow(s[i,2] - traplocs[j,2],2) \n p[i,j,1]       <-  p0[i,1]*exp( - beta.vec[i,1]*dist2[i,j] )\n p[i,j,2]       <-  1-exp(-p0[i,2]*exp( - beta.vec[i,2]*dist2[i,j] ) )\n logit(p[i,j,3])<- p0[i,3] - beta.vec[i,3]*dist2[i,j]\n\n}\n\n}\n\n\nN<-sum(w[1:M])\nD<-N/area\n}\n", 
        fill = TRUE)
    sink()
    sst <- traplocs[sample(1:nrow(traplocs), M, replace = TRUE), 
        ]
    wst <- c(rep(1, nind), rep(0, M - nind))
    mod <- 1
    data <- list("y", "traplocs", "M", "ntraps", "K", "Xl", "Xu", 
        "Yl", "Yu", "area")
    inits <- function() {
        list(psi = 0.5, alpha0 = rnorm(3, -2, 0.5), sigma = runif(3, 
            1, 2), w = wst, s = sst, mod = 1)
    }
    parameters <- c("mod", "psi", "sigma", "beta", "alpha0", 
        "N", "D")
    out <- bugs(data, inits, parameters, "modelfile5.txt", n.thin = 1, 
        n.chains = 3, n.burnin = nb, n.iter = ni, working.dir = getwd())
    out
  }
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
