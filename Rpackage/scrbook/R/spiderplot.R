spiderplot<-function (y, traplocs) 
{
# 2-d is assumed to be a multinomial 
# 3-d is binomial encounter data or Poisson

if(length(dim(y))==3){
y3d<-y
    J <- dim(y3d)[3]
    T <- dim(y3d)[2]
    nind <- dim(y3d)[1]
    plot(traplocs, pch = 20, xlab = " ", ylab = " ")
    avg.s <- matrix(NA, nrow = nind, ncol = 2)
    for (i in 1:nind) {
        tmp <- NULL
        for (t in 1:T) {
            aa <- y3d[i, t, ]
            if (sum(aa) > 0) {
                aa <- traplocs[aa > 0, ]
                tmp <- rbind(tmp, aa)
            }
        }
        avg.s[i, ] <- c(mean(tmp[, 1]), mean(tmp[, 2]))
        points(avg.s[i, 1], avg.s[i, 2], pch = 20, cex = 2, col = "red")
        for (m in 1:nrow(tmp)) {
            if (nrow(tmp) > 1) 
                lines(c(avg.s[i, 1], tmp[m, 1]), c(avg.s[i, 2], 
                  tmp[m, 2]))
        }
    }
}


if(length(dim(y))==2){
y2d<-y
    J <- nrow(traplocs)
    T <- dim(y2d)[2]
    nind <- dim(y2d)[1]
    plot(traplocs, pch = 20, xlab = " ", ylab = " ")
    avg.s <- matrix(NA, nrow = nind, ncol = 2)
    for (i in 1:nind) {
        tmp <- NULL
        for (t in 1:T) {
            aa <- y2d[i, t]
            if (aa <= J){
                aa <- traplocs[aa, ]
                tmp <- rbind(tmp, aa)
            }
        }
        avg.s[i, ] <- c(mean(tmp[, 1]), mean(tmp[, 2]))
        points(avg.s[i, 1], avg.s[i, 2], pch = 20, cex = 2, col = "red")
        for (m in 1:nrow(tmp)) {
            if (nrow(tmp) > 1) 
                lines(c(avg.s[i, 1], tmp[m, 1]), c(avg.s[i, 2], 
                  tmp[m, 2]))
        }
    }
}







    points(traplocs, pch = 20)
    Cx <- mean(traplocs[, 1])
    Cy <- mean(traplocs[, 2])
    xcent <- sqrt((avg.s[, 1] - Cx)^2 + (avg.s[, 2] - Cy)^2)
    list(xcent = xcent, avg.s = avg.s, center = c(Cx, Cy))
}
