%% This is file `elsst-book.sty'
%%
%% LaTeX 2e style file for the processing of LaTeX2e files
%% for the Elsevier Science and Technology books
%% Must be used together with standart LaTeX2e 'book.cls'
%%
%%
%% Macros written by Vytas Statulevicius, VTeX, Lithuania
%% Please submit bugs or your comments to vytas@vtex.lt
%%
%% This style file contains additional macros and is designed to use
%% with standart "books.cls"
%%
%% You are free to use this style file as you see fit, provided 
%% that you do not make changes to the file. 
%% If you DO make changes, you are required to rename this file.
%%
%% It may be distributed under the terms of the LaTeX Project Public
%% License, as described in lppl.txt in the base LaTeX distribution.
%% Either version 1.0 or, at your option, any later version.
%%
%% \CharacterTable
%%  {Upper-case    \A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\W\X\Y\Z
%%   Lower-case    \a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\w\x\y\z
%%   Digits        \0\1\2\3\4\5\6\7\8\9
%%   Exclamation   \!     Double quote  \"     Hash (number) \#
%%   Dollar        \$     Percent       \%     Ampersand     \&
%%   Acute accent  \'     Left paren    \(     Right paren   \)
%%   Asterisk      \*     Plus          \+     Comma         \,
%%   Minus         \-     Point         \.     Solidus       \/
%%   Colon         \:     Semicolon     \;     Less than     \<
%%   Equals        \=     Greater than  \>     Question mark \?
%%   Commercial at \@     Left bracket  \[     Backslash     \\
%%   Right bracket \]     Circumflex    \^     Underscore    \_
%%   Grave accent  \`     Left brace    \{     Vertical bar  \|
%%   Right brace   \}     Tilde         \~}
%%
%%
%% Bug fixes and changes: at the end of file

% TeX programming: Vytas Statulevicius, VTeX, Lithuania, vytas@vtex.lt
% Requires Latex2e, ver.2000.06

\def\elsstfmt@version{2005/05/05}

\ProvidesFile{elsst-book.sty}
        [\elsstfmt@version Elsevier S&T 'book' style (VS)]

% hyperref must be loaded after:
\@ifpackageloaded{hyperref}{\@latex@error{Package 'hyperref' must be loaded after 'imsart'!}\@ehc}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Options

% Use the trim size as papersize:
\newif\if@trimpapersize
\DeclareOption{trimpapersize}{\@trimpapersizetrue}

% Load crop.sty  for cropmarks:
\newif\if@load@crop
\DeclareOption{crop}{\@load@croptrue}

%% Trim size (book model):
\DeclareOption{6x9}{
    \def\elsst@trimwidth{6in}
    \def\elsst@trimheight{9in}
    \def\elsst@textwidth{30pc}
    \def\elsst@textheight{42pc}% 43 lines
    \def\elsst@oddsidemargin{18mm}
    \def\elsst@topmargin{17mm}
                    }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% EXECUTE OPTIONS

\ExecuteOptions{6x9}
\ProcessOptions

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% DIMENSIONS
% TEXT DIMENSIONS
\setlength\parindent {15\p@}
\setlength\textwidth    {\elsst@textwidth}
\setlength\textheight   {\elsst@textheight}
\advance\textheight by \topskip
\setlength\columnsep    {24\p@}
\setlength\columnseprule{0\p@}
\columnwidth=\textwidth
\advance\columnwidth by-\columnsep
\divide\columnwidth by2

% HEADS:
\setlength\headheight{12\p@}
\setlength\headsep   {14\p@}
\setlength\topskip   {10\p@}
\setlength\footskip  {24\p@}
\setlength\maxdepth  {.5\topskip}

% SIDE MARGINS
\setlength\oddsidemargin   {\elsst@oddsidemargin}
\@tempdima=\elsst@trimwidth
\advance\@tempdima by-\oddsidemargin
\advance\@tempdima by-\textwidth
\setlength\evensidemargin  {\@tempdima}%   outer

\setlength\topmargin       {\elsst@topmargin}
\advance\topmargin by-5pt

% BREAKS
\setlength\smallskipamount{6\p@ \@plus 1\p@ \@minus 1\p@}
\setlength\medskipamount  {12\p@ \@plus 3\p@ \@minus 3\p@}
\setlength\bigskipamount  {18\p@ \@plus 3\p@ \@minus 3\p@}

% Set to point:
\@settopoint\textwidth
\@settopoint\textheight
\@settopoint\columnwidth
\@settopoint\oddsidemargin
\@settopoint\evensidemargin
\@settopoint\topmargin

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% putting text area on page

\if@trimpapersize
  \voffset=-1in
  \hoffset=-1in
  \setlength\paperwidth {\elsst@trimwidth}
  \setlength\paperheight{\elsst@trimheight}
  \def\special@papersize{\AtBeginDvi{\special{papersize=\the\paperwidth, \the\paperheight}}}
\else % center on page
  \@tempdima=\paperwidth  \advance\@tempdima by-\elsst@trimwidth
  \divide\@tempdima by2   \advance\@tempdima by-1in
  \hoffset=\@tempdima

  \@tempdima=\paperheight \advance\@tempdima by-\elsst@trimheight
  \divide\@tempdima by2    \advance\@tempdima by-1in
  \voffset=\@tempdima
\fi


% if option 'crop' is specified, print the cropmarks:

\if@load@crop
   \newdimen\stockwidth
   \stockwidth\paperwidth
   \newdimen\stockheight
   \stockheight\paperheight

   \paperwidth\elsst@trimwidth
   \paperheight\elsst@trimheight

   \advance\oddsidemargin by-1in
   \advance\evensidemargin by-1in
   \advance\topmargin by-1in

% if *trimpapersize* is specified, we will print according to Elsevier requirements
  \if@trimpapersize
    \stockwidth=\elsst@trimwidth   \advance\stockwidth  by1in
    \@settopoint\stockwidth
    \stockheight=\elsst@trimheight \advance\stockheight by1in
    \@settopoint\stockheight
  \fi
  \RequirePackage[cam,center]{crop}
\else
  \csname special@papersize\endcsname
\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% address, maketitle

\def\subtitle#1{\gdef\@subtitle{#1}}
\def\address#1{\gdef\@address{#1}}
\let\affiliation\address
\let\@author\@undefined

\def\maketitle{%
  \@maketitle
  \global\let\title\relax
  \global\let\subtitle\relax
  \global\let\author\relax
  \global\let\address\relax
  \global\let\affiliation\relax
  \global\let\@title\@empty
  \global\let\@subtitle\@empty
  \global\let\@author\@empty
  \global\let\@address\@empty}


\def\@maketitle{%
  \newpage
  \thispagestyle{empty} 
  \vglue 35pt
  \noindent\rule{\textwidth}{1pt}\par
  \bgroup
    \centering\sffamily
    {\fontsize{28}{42}\selectfont\@title\par}
    \vskip32pt
    \@ifundefined{@subtitle}{}{{\fontsize{20}{22}\selectfont\@subtitle\par}}
    \vspace{20pt}
    \@ifundefined{@author}{}{{\fontsize{20}{22}\selectfont\@author\par}}
    \vskip 10pt
    {\fontsize{10}{12}\selectfont\@address\par}
    \vfill 
    {\normalfont\publisher@text\par}
  \egroup
  \clearpage
    }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% part

\def\part{\cleardoublepage
          \thispagestyle{empty}
          \secdef\@part\@spart}

\def\@part[#1]#2{%
   \refstepcounter{part}%
   \begingroup%
     \no@harm%
     \xdef\@argi{#2}%
   \endgroup%
   \addcontentsline{toc}{part}{\protect\numberline{\thepart}\@argi}%
   \markboth{}{}%
   \@makeparthead{#2}%
}


\def\@makeparthead#1{%
   \vspace*{24\p@}
   \bgroup
     \centering\sffamily\bfseries
     {\huge\partname\ \thepart\par}
     \vskip12\p@
     \noindent\rule{\textwidth}{1pt}\par
     \vskip12\p@
     {\Huge #1\par}
   \egroup
   \vfill
   \clearpage
}


\def\@spart#1{%
   \begingroup%
     \no@harm%
     \xdef\@argi{#1}%
   \endgroup%
   \addcontentsline{toc}{part}{\@argi}%
   \markboth{}{}%
   \@makesparthead{#1}%
}


\def\@makesparthead#1{%
   \vspace*{24\p@}
   \bgroup
     \centering\sffamily
     {\phantom{\huge\partname\ \thepart}\par}
     \vskip12\p@
     \noindent\rule{\textwidth}{1pt}\par
     \vskip12\p@
     {\huge #1\par}
   \egroup
   \vfill
   \clearpage
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  chapter

\def\@makechapterhead#1{%
  \vspace*{10\p@}%
  \bgroup
    \centering%
    \sffamily\bfseries
    \interlinepenalty\@M
    \ifappend
         {\LARGE\appendixname\ \thechapter\par}
    \else
      \if@mainmatter
         {\fontsize{40}{40}\selectfont\thechapter\par}
      \else
         {\phantom{\fontsize{40}{40}\selectfont\thechapter}\par}
      \fi
    \fi
    \vskip-12pt
    \rule{\textwidth}{1pt}
    {\LARGE\MakeUppercase{#1}\par}
  \egroup
  \vskip 81pt
}

\def\@makeschapterhead#1{%
  \vspace*{24\p@}%
  \bgroup
    \centering
    \sffamily\bfseries
    \interlinepenalty\@M
    \LARGE\MakeUppercase{#1}\par
    \rule{\textwidth}{1pt}
    \vskip 20\p@ plus 6pt
  \egroup
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% sections

\renewcommand\section{\@startsection {section}{1}{\z@}%
                                   {-\bigskipamount}%
                                   {\smallskipamount}%
                                   {\normalsize\sffamily\bfseries\mathversion{bold}\raggedright\nohyphen\MakeUppercase}}
\renewcommand\subsection{\@startsection {subsection}{2}{\z@}%
                                   {-\bigskipamount}%
                                   {\smallskipamount}%
                                   {\normalsize\sffamily\bfseries\mathversion{bold}\raggedright\nohyphen}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
                                     {-\smallskipamount}%
                                     {.1\p@}%
                                     {\normalsize\sffamily\bfseries\mathversion{bold}\raggedright\nohyphen}}
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
                                    {\smallskipamount}%
                                    {-1em}%
                                    {\normalfont\normalsize\itshape}}
\renewcommand\subparagraph{\@startsection{subparagraph}{5}{\parindent}%
                                       {\smallskipamount}%
                                       {-1em}%
                                      {\normalsize\itshape}}

% Format for the counter:
\def\@seccntformat#1{{\csname the#1\endcsname\enspace}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% running heads

\def\rh@rule{\leavevmode\lower4\p@\hbox to\z@{\vrule height.5pt width\textwidth\hss}}

% Normalus RH
\def\ps@headings{\let\@mkboth\@gobbletwo%
      \let\@oddfoot\@empty%
      \let\@evenfoot\@empty%
      \def\@evenhead{\rh@rule\runninghead@size\rlap{\pagenumber@size\thepage}\hfill\leftmark\hfill}%
      \def\@oddhead{\rh@rule\runninghead@size\hfill\rightmark\hfill\llap{\pagenumber@size\thepage}}%
}%
% Tuscias RH
\def\ps@empty{\let\@mkboth\@gobbletwo%
     \let\@oddhead\@empty%
     \let\@oddfoot\@empty%
     \let\@evenhead\@oddhead%
     \let\@evenfoot\@oddfoot}
%
% RH  su puslapio numeriu apacioje
\def\ps@plain{\let\@mkboth\@gobbletwo%
     \let\@oddhead\@empty%
     \let\@oddfoot\@empty%
     \let\@evenhead\@oddhead%
     \def\@oddfoot{\hfill\pagenumber@size\thepage\hfill}%
     \def\@evenfoot{\hfill\pagenumber@size\thepage\hfill}}

\def\chaptermark#1{\markboth{\MakeUppercase{#1}}{\MakeUppercase{#1}}}
\def\sectionmark#1{\markright{\MakeUppercase{#1}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% table, figure

\setlength\belowcaptionskip{4\p@}

\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{\small\sffamily\textbf{#1.}\enskip #2}%
  \ifdim \wd\@tempboxa >\hsize
    \unhbox\@tempboxa
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}

\def\@floatboxreset{%
        \reset@font
        \footnotesize
        \@setminipage
        \centering
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% equations

\@addtoreset{equation}{section}
\def\theequation{\thesection.\arabic{equation}}
\arraycolsep 1.5pt 
\tabcolsep 4pt 
\arrayrulewidth .5pt
\doublerulesep 2pt 
\tabbingsep\labelsep

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% list

% general list indent
\def\list@parindent{15\p@}

% enumerate
\def\enumerate@indent{\list@parindent}
\def\enumerate@parindent{\list@parindent}
\def\enumerate@labelsep{.5em}
\def\enumerate@firsttopsep{\smallskipamount}
\def\enumerate@topsep{\smallskipamount}
\def\enumerate@rightskip{\z@}% {\z@ plus 1fill}
\let\enumerate@hook\relax

% itemize
\def\itemize@indent{\z@}
\def\itemize@parindent{\list@parindent}
\def\itemize@labelsep{.5em}
\def\itemize@firsttopsep{\smallskipamount}
\def\itemize@topsep{\z@}
\def\itemize@rightskip{\z@}% {\z@ plus 1fill}
\let\itemize@hook\relax

% description
\def\description@indent{\list@parindent}
\let\description@topsep\smallskipamount
\let\description@hook\relax

% quotation
\let\quotation@size\footnotesize
\def\quotation@itemindent{\list@parindent}
\def\quotation@parindent{\list@parindent}
\def\quotation@leftmargin{\list@parindent}
\let\quotation@rightmargin\z@
\let\quotation@topsep\smallskipamount

% quote
\let\quote@size\footnotesize
\def\quote@indent{\z@}
\def\quote@leftmargin{2pc}
\def\quote@rightmargin{2pc}
\let\quote@topsep\smallskipamount

% verse
\def\verse@margin{2pc}
\let\verse@topsep\smallskipamount

%%%%%%%%%%%%%% Enumerate

\def\enumerate{\@ifnextchar[{\@enumerate}{\@enumerate[]}}

\def\@enumerate[#1]{%
    \ifnum \@enumdepth >\thr@@ \@toodeep\else
    \advance\@enumdepth \@ne 
    \edef\@enumctr{enum\romannumeral\the\@enumdepth}%
    \list {\csname label\@enumctr\endcsname}%
       {\usecounter{\@enumctr}
        \def\makelabel##1{{\hfill\normalfont ##1}}
%
        \ifx.#1.%
           \setcounter{\@enumctr}{3}% 
           \expandafter\settowidth\expandafter\labelwidth\expandafter{\csname label\@enumctr\endcsname}%
           \setcounter{\@enumctr}{0}%
        \else%
           \settowidth{\labelwidth}{#1}
        \fi%
        \labelsep=\enumerate@labelsep%
        \itemindent=\labelwidth \advance\itemindent\labelsep%
        \ifnum \@enumdepth=1\advance\itemindent by\enumerate@indent\fi%
        \leftmargin=\the\itemindent%
        \itemindent\z@%
        \partopsep\z@  \parsep\z@ \itemsep\z@ \rightmargin\z@
        \ifnum \@enumdepth=1 \topsep\enumerate@firsttopsep \else \topsep\enumerate@topsep\fi%
        \listparindent\enumerate@parindent%        
        \@rightskip\enumerate@rightskip%
        \enumerate@hook% 
        }\fi}


%%%%%%%%%%%%%%  itemize

\def\itemize{\@ifnextchar[{\@itemize}{\@itemize[]}}

\def\@itemize[#1]{%
    \ifnum \@itemdepth >\thr@@ \@toodeep\else
    \advance\@itemdepth \@ne 
    \edef\@itemitem{labelitem\romannumeral\the\@itemdepth}%
    \list {\csname\@itemitem\endcsname}%
       {\def\makelabel##1{{\hfill\normalfont ##1}}        
%
        \ifx.#1.%
           \settowidth\labelwidth{\csname\@itemitem\endcsname}%
        \else%
           \settowidth{\labelwidth}{#1}
        \fi%
        \labelsep=\itemize@labelsep%
        \itemindent=\labelwidth \advance\itemindent\labelsep%
        \ifnum \@itemdepth=1\advance\itemindent by\itemize@indent\fi%
        \leftmargin=\the\itemindent%
        \itemindent\z@%
        \partopsep\z@  \parsep\z@ \itemsep\z@ \rightmargin\z@
        \ifnum \@itemdepth=1 \topsep\itemize@firsttopsep \else \topsep\itemize@topsep\fi%
        \listparindent\itemize@parindent%        
        \@rightskip\itemize@rightskip%
        \itemize@hook% 
        }\fi}

%%%%%%%%%%%%%%  description

\def\description{%
         \list{}{\labelwidth\z@ \labelsep\z@  \rightmargin\z@
         \leftmargin\z@ \advance\leftmargin by\description@indent
         \itemindent-\description@indent
         \partopsep\z@ \topsep\description@topsep \parsep\z@
         \itemsep\z@ \listparindent\z@
         \description@hook%
         \let\makelabel\descriptionlabel}}

\def\enddescription{\endlist}

\def\descriptionlabel#1{\if.#1.\else\bfseries #1\hskip.5em\fi}

%%%%%%%%%%%%%%  quotation

\def\quotation{%
        \list{}{\quotation@size%
        \listparindent\quotation@parindent%
        \itemindent   \quotation@itemindent%
        \rightmargin\quotation@rightmargin   \leftmargin\quotation@leftmargin%
        \partopsep\z@ \topsep\quotation@topsep \parsep\z@%
                        }%
        \item[\Q@strut]\relax}

\def\endquotation{\endlist}

\def\Q@strut{\leavevmode\hbox{\vrule height9pt depth1pt width0pt}}

%%%%%%%%%%%%%%  quote

\def\quote{%
        \list{}{\quote@size%
        \listparindent\quote@indent%
        \itemindent \listparindent%
        \rightmargin\quote@rightmargin   \leftmargin\quote@leftmargin%
        \partopsep\z@ \topsep\quote@topsep \parsep\z@%
                       }%
        \item\relax}

\def\endquote{\endlist}

%%%%%%%%%%%%%%  verse


\def\verse{%
   \let\\\@centercr
   \list{}{\itemindent\z@ \listparindent\z@ \rightmargin\verse@margin \leftmargin\rightmargin
	   \partopsep\z@ \parsep\z@ \topsep\verse@topsep \itemsep\z@}%
   \item\relax}

\def\endverse{\endlist}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% appendix
\newif\ifappend

\def\appendix{\clearpage\thispagestyle{empty}
  \setcounter{chapter}{0}
  \setcounter{section}{0}
  \setcounter{subsection}{0}
  \appendtrue
  \def\@chapapp{App.\ }
  \def\thechapter{\Alph{chapter}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% thebibliography

% normal *numbered* bibliography
\def\@openbib@code{\addcontentsline{toc}{chapter}{Bibliography}\markboth{BIBLIOGRAPHY}{BIBLIOGRAPHY}\itemsep\z@}

% check for natbib package:
\def\check@natbib{%
\@ifpackageloaded{natbib}{% natbib is loaded
    \setlength\bibsep{0pt}%
    \renewcommand{\bibsection}{%
      \chapter*{\bibname}
      \markboth{BIBLIOGRAPHY}{BIBLIOGRAPHY}
      \csname phantomsection\endcsname
      \addcontentsline{toc}{chapter}{\bibname}}
}{}}

\AtBeginDocument{\check@natbib}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% support for amsthm

\def\check@amsthm{%
\@ifpackageloaded{amsthm}{%
     \newtheoremstyle{plain}     {\medskipamount}{\medskipamount}{\itshape}{}{\bfseries}{}{1em}{}
     \newtheoremstyle{definition}{\medskipamount}{\medskipamount}{\normalfont}{}{\bfseries}{}{1em}{}
     \newtheoremstyle{remark}    {\medskipamount}{\medskipamount}{\normalfont}{}{\bfseries}{}{1em}{}
%
\@ifundefined{blacksquare}{}{\def\qed{\hfill\ensuremath{\blacksquare}}}
%
\renewenvironment{proof}[1][\proofname]{\par
  \setlength\labelsep{1em}
  \normalfont
  \topsep6\p@\@plus6\p@ \list{}{\leftmargin 18pt \labelwidth 0pt}
  \item[\hskip\labelsep\itshape
    ##1\@addpunct{.}]\ignorespaces}{\qed\endlist}
}{}}

\AtBeginDocument{\check@amsthm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% table of contents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% support macros

% no rh on empty pages
\def\cleardoublepage{\clearpage\ifodd\c@page\else\hbox{}\thispagestyle{empty}\newpage\fi}

%
\def\no@harm{\let\thanks=\@gobble\let~\space \let\\=\@empty \def\protect{\noexpand\protect\noexpand}}

%
\def\nohyphen{\pretolerance=\@M \tolerance=\@M \hyphenpenalty=\@M \exhyphenpenalty=\@M}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% setattribute, getattribute, do@option@list

\def\setattribute{\@ifnextchar[\@setattribute{\@setattribute[]}}
\def\@setattribute[#1]#2#3#4{\expandafter\gdef\csname #2@#3\endcsname{#4}}
\def\getattribute#1#2{\csname #1@#2\endcsname}
\def\sep@key@value#1=#2/?/#3{\setattribute{#3}{#1}{#2}}
\def\do@option@list#1#2{%
  \@for\curr@option:={#2}\do{%
    \expandafter\sep@key@value\curr@option/?/{#1}\relax
  }%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% settings

\setattribute{runninghead}{size} {\sffamily\small}
\setattribute{pagenumber} {size} {\normalsize\bfseries}


\setattribute{publisher}{text}{ACADEMIC PRESS}

\ps@headings

\endinput 
